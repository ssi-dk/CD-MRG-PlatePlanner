
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../study/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Plates - </title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#plate-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plates
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="custom_light" data-md-color-primary="white" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Plates
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Plates
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.plate" class="md-nav__link">
    <span class="md-ellipsis">
      plate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.Plate" class="md-nav__link">
    <span class="md-ellipsis">
      Plate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.capacity" class="md-nav__link">
    <span class="md-ellipsis">
      capacity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.column_labels" class="md-nav__link">
    <span class="md-ellipsis">
      column_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.plate_id" class="md-nav__link">
    <span class="md-ellipsis">
      plate_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.row_labels" class="md-nav__link">
    <span class="md-ellipsis">
      row_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.add_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      add_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      as_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_figure" class="md-nav__link">
    <span class="md-ellipsis">
      as_figure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_records" class="md-nav__link">
    <span class="md-ellipsis">
      as_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.assign_well_color" class="md-nav__link">
    <span class="md-ellipsis">
      assign_well_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.create_alphanumerical_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      create_alphanumerical_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.create_index_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      create_index_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.get_metadata_as_numpy_array" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata_as_numpy_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.is_valid_metadata_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_metadata_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.QCPlate" class="md-nav__link">
    <span class="md-ellipsis">
      QCPlate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QCPlate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.QCPlate.create_QC_plate_layout" class="md-nav__link">
    <span class="md-ellipsis">
      create_QC_plate_layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.QCPlate.define_unique_QC_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      define_unique_QC_sequences
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.Well" class="md-nav__link">
    <span class="md-ellipsis">
      Well
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Well">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.get_attribute_or_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_attribute_or_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_attribute_or_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.get_attribute_or_metadata--retrieve-attribute-and-metadata-values-from-a-well-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieve attribute and metadata values from a Well instance:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../study/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Studies
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.plate" class="md-nav__link">
    <span class="md-ellipsis">
      plate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.Plate" class="md-nav__link">
    <span class="md-ellipsis">
      Plate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.capacity" class="md-nav__link">
    <span class="md-ellipsis">
      capacity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.column_labels" class="md-nav__link">
    <span class="md-ellipsis">
      column_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.plate_id" class="md-nav__link">
    <span class="md-ellipsis">
      plate_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.row_labels" class="md-nav__link">
    <span class="md-ellipsis">
      row_labels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.__setitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __setitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.add_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      add_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      as_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_figure" class="md-nav__link">
    <span class="md-ellipsis">
      as_figure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.as_records" class="md-nav__link">
    <span class="md-ellipsis">
      as_records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.assign_well_color" class="md-nav__link">
    <span class="md-ellipsis">
      assign_well_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.create_alphanumerical_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      create_alphanumerical_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.create_index_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      create_index_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.get_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.get_metadata_as_numpy_array" class="md-nav__link">
    <span class="md-ellipsis">
      get_metadata_as_numpy_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.is_valid_metadata_key" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_metadata_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Plate.to_file" class="md-nav__link">
    <span class="md-ellipsis">
      to_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.QCPlate" class="md-nav__link">
    <span class="md-ellipsis">
      QCPlate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QCPlate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.QCPlate.create_QC_plate_layout" class="md-nav__link">
    <span class="md-ellipsis">
      create_QC_plate_layout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.QCPlate.define_unique_QC_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      define_unique_QC_sequences
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.plate.Well" class="md-nav__link">
    <span class="md-ellipsis">
      Well
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Well">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.get_attribute_or_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      get_attribute_or_metadata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_attribute_or_metadata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.plate.Well.get_attribute_or_metadata--retrieve-attribute-and-metadata-values-from-a-well-instance" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieve attribute and metadata values from a Well instance:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="plate-documentation">Plate Documentation</h1>


<div class="doc doc-object doc-module">



<a id="src.plate"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="src.plate.Plate" class="doc doc-heading">
          <code>Plate</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A class to represent a multiwell plate.</p>
<p>This class manages a multiwell plate, with functionalities to access, modify, and visualize
the wells, along with their metadata.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="src.plate.Plate._default_n_rows">_default_n_rows</span></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default number of rows in the plate.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Plate._default_n_columns">_default_n_columns</span></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default number of columns in the plate.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Plate._default_well_color">_default_well_color</span></code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[float, float, float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default RGB color of the wells.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Plate._default_exclude_metadata">_default_exclude_metadata</span></code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default metadata keys to exclude.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Plate._default_colormap">_default_colormap</span></code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default colormap for visualizations.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>plate_dim</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dimensions of the plate as (rows, columns).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>plate_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A unique identifier for the plate.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>src/plate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Plate</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to represent a multiwell plate.</span>

<span class="sd">    This class manages a multiwell plate, with functionalities to access, modify, and visualize</span>
<span class="sd">    the wells, along with their metadata.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _default_n_rows (int): Default number of rows in the plate.</span>
<span class="sd">        _default_n_columns (int): Default number of columns in the plate.</span>
<span class="sd">        _default_well_color (Tuple[float, float, float]): Default RGB color of the wells.</span>
<span class="sd">        _default_exclude_metadata (list): Default metadata keys to exclude.</span>
<span class="sd">        _default_colormap (str): Default colormap for visualizations.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        plate_dim (Tuple[int, int], optional): The dimensions of the plate as (rows, columns).</span>
<span class="sd">        plate_id (int, optional): A unique identifier for the plate.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_default_n_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">_default_n_columns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">_default_well_color</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_default_exclude_metadata</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rgb_color&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinate&quot;</span><span class="p">]</span>
    <span class="n">_default_colormap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;tab20&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plate_dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">plate_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a new Plate instance.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            plate_dim (Tuple[int, int], optional): The dimensions of the plate as (rows, columns).</span>
<span class="sd">                If None, default dimensions are used.</span>
<span class="sd">            plate_id (int, optional): A unique identifier for the plate.</span>

<span class="sd">        The constructor initializes the plate with the specified dimensions, generating wells </span>
<span class="sd">        with default properties and assigning them unique coordinates and identifiers.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Creating a Plate instance with default dimensions and a specific plate ID:</span>

<span class="sd">            &gt;&gt;&gt; plate = Plate(plate_id=1)</span>
<span class="sd">            &gt;&gt;&gt; plate.size  # This will depend on the default number of rows and columns</span>
<span class="sd">            96  # Example output, assuming 8 rows x 12 columns</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_plate_dimensions</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_alphanumerical_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_alphanumerical_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_index_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="p">[</span><span class="n">Well</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_alphanumerical_coordinates</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> 
                           <span class="n">coordinate</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> 
                           <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> 
                           <span class="n">plate_id</span><span class="o">=</span><span class="n">plate_id</span><span class="p">,</span> 
                           <span class="n">rgb_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">))]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span> <span class="o">=</span> <span class="n">plate_id</span>

        <span class="c1"># dictionary to map well names to indices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_name_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="si">}</span><span class="s2"> plate with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> wells.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of wells in the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of wells.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">plate_summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Plate ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Dimensions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="si">}</span><span class="s2"> rows x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="si">}</span><span class="s2"> columns</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="s2">&quot;Plate Layout (Well Names):</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_array_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_as_numpy_array</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="n">plate_array_str</span>
        <span class="k">return</span> <span class="n">plate_summary</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve a well from the plate based on its index, coordinate, or name.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            key (int, tuple, or str): The identifier for the well. Can be an integer index, </span>
<span class="sd">            a tuple indicating row and column coordinates, or a string specifying the well&#39;s name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Well: The well object corresponding to the given key.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the key is not an integer, tuple, or string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># Access by index</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># Access by coordinate</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates_to_index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># Access by name</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Key must be an integer, tuple, or string&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">well_object</span><span class="p">:</span> <span class="n">Well</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set or replace a well in the plate based on its index, coordinate, or name.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            key (int, tuple, or str): The identifier for the well to be set or replaced. </span>
<span class="sd">                Can be an integer index, a tuple indicating row and column coordinates, or a string specifying the well&#39;s name.</span>
<span class="sd">        well_object (Well): The well object to set at the specified key.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the well_object is not an instance of Well.</span>
<span class="sd">            IndexError: If the well index is out of range.</span>
<span class="sd">            TypeError: If the key is not a string, integer, or tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">well_object</span><span class="p">,</span> <span class="n">Well</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be an instance of Well&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Well index out of range&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates_to_index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_name_map</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Key must be a string, integer, or tuple&quot;</span><span class="p">)</span>

        <span class="c1"># Update the well object&#39;s attributes</span>
        <span class="n">well_object</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">well_object</span><span class="o">.</span><span class="n">coordinate</span> <span class="o">=</span> <span class="n">coordinate</span>
        <span class="n">well_object</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="n">well_object</span><span class="o">.</span><span class="n">plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span>

        <span class="c1"># Update the well at the specified index on the plate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">well_object</span>
        <span class="c1"># Update the name-to-index mapping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">_parse_plate_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plate_dim</span> <span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse the dimensions of the plate and return the number of rows and columns.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            plate_dim (tuple, list, dict, or int): The dimensions of the plate. This can be a tuple or list </span>
<span class="sd">                specifying (rows, columns), a dictionary with &#39;rows&#39; and &#39;columns&#39; keys, or an integer specifying </span>
<span class="sd">                the total number of wells in a 2:3 format (e.g., 96 wells as 8x12).</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple containing the number of rows and columns (rows, columns).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the plate_dim format is unsupported or incorrect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plate_dim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_n_columns</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">plate_dim</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Plate dimension must be a tuple or list with two elements (rows, columns).&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">plate_dim</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rows&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_n_rows</span><span class="p">),</span> <span class="n">plate_dim</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_n_columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># design a plate in format 2 : 3 as in </span>
            <span class="c1"># 6, 12, 24, 48, 96, 384 or 1536 plates  </span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">plate_dim</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported plate format: Must be a tuple, list, dict, or integer.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_coordinates_to_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a well coordinate to its corresponding index in the plate&#39;s well list.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            coordinate (tuple): The row and column coordinate of the well (row, col).</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The index of the well corresponding to the given coordinate.</span>

<span class="sd">        Raises:</span>
<span class="sd">            IndexError: If the coordinate is out of range of the plate&#39;s dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">coordinate</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Coordinate out of range&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">row</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span> <span class="o">+</span> <span class="n">col</span>

    <span class="k">def</span> <span class="nf">_to_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a list of data corresponding to each well into a numpy array matching the plate&#39;s layout.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            data (list): A list of data values corresponding to each well in the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: A numpy array representing the plate&#39;s layout with the provided data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Warning: If the number of data elements does not match the plate&#39;s size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create an empty array of the right shape</span>
        <span class="n">plate_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

        <span class="c1"># Check if the data list matches the number of wells</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of data elements (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">) does not match the plate&#39;s size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>

        <span class="c1"># Populate the array with data</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_coordinates</span><span class="p">):</span>
            <span class="n">plate_array</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">plate_array</span><span class="p">)</span>  <span class="c1"># Flip to match the physical layout</span>

    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve metadata values for all wells in the plate based on the specified key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            metadata_key (str, optional): The metadata key for which values are to be retrieved. </span>
<span class="sd">                If None, a default value of &#39;NaN&#39; is returned for each well.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of metadata values for each well in the plate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">metadata_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;NaN&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">]</span>

        <span class="n">metadata_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
            <span class="n">metadata_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">metadata_values</span>

    <span class="k">def</span> <span class="nf">get_metadata_as_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve metadata values for all wells in a numpy array format based on the specified key.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            metadata_key (str): The metadata key for which values are to be retrieved.</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: A numpy array representing the metadata values for the plate&#39;s layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_numpy_array</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">assign_well_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">colormap</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign colors to each well in the plate based on the specified metadata key and colormap.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            metadata_key (str, optional): The metadata key to use for coloring the wells. </span>
<span class="sd">                If None, a default color is assigned to each well.</span>
<span class="sd">        colormap (str): The name of the colormap to use for coloring the wells.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the metadata_key is invalid or not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_colormap</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">metadata_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">metadata_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
            <span class="n">unique_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">metadata_values</span><span class="p">)</span>

            <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
            <span class="n">color_norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">scalar_map</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">color_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_values</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;NaN&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">scalar_map</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># RGB color</span>

            <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
                <span class="n">metadata_value</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
                <span class="n">well</span><span class="o">.</span><span class="n">rgb_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadata_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Assign default color when metadata_key is None</span>
            <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
                <span class="n">well</span><span class="o">.</span><span class="n">rgb_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span>

    <span class="k">def</span> <span class="nf">as_records</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the plate&#39;s well data into a list of dictionaries.</span>

<span class="sd">        Each well&#39;s attributes are converted into a dictionary, and all these dictionaries</span>
<span class="sd">        are compiled into a list, with one dictionary per well.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list of dict: A list where each element is a dictionary representing a well&#39;s attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">as_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the plate data into a Pandas DataFrame.</span>

<span class="sd">        Each well and its attributes are represented as a row in the DataFrame.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pandas.DataFrame: A DataFrame representing the plate&#39;s wells and their attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_records</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">is_valid_metadata_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the provided key is a valid metadata key for the Well instances in the plate.</span>

<span class="sd">        This method verifies whether the specified key is either a direct attribute of the Well instances</span>
<span class="sd">        or a key within their metadata dictionary.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            key (str): The key to check for validity as a metadata key.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the key is a valid metadata key, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>  <span class="c1"># If key is None or empty</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check if the key is a direct attribute or in the metadata dictionary of any well</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">well</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">as_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">annotation_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">color_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                  <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                  <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                  <span class="n">well_size</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span>
                  <span class="n">fig_width</span><span class="o">=</span><span class="mf">11.69</span><span class="p">,</span>
                  <span class="n">fig_height</span><span class="o">=</span><span class="mf">8.27</span><span class="p">,</span>
                  <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                  <span class="n">plt_style</span><span class="o">=</span><span class="s2">&quot;bmh&quot;</span><span class="p">,</span>
                  <span class="n">grid_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                  <span class="n">edge_color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                  <span class="n">legend_bb</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span>
                  <span class="n">legend_n_columns</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                  <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a visual representation of the plate using matplotlib.</span>

<span class="sd">        This method generates a figure representing the plate, with options for annotations,</span>
<span class="sd">        coloring based on metadata, and various styling adjustments.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            annotation_metadata_key (str, optional): Metadata key to use for annotating wells.</span>
<span class="sd">            color_metadata_key (str, optional): Metadata key to determine the color of wells.</span>
<span class="sd">            fontsize (int, optional): Font size for annotations. Default is 8.</span>
<span class="sd">            rotation (int, optional): Rotation angle for annotations. Default is 0.</span>
<span class="sd">            step (int, optional): Step size between wells in the grid. Default is 10.</span>
<span class="sd">            title_str (str, optional): Title of the figure. If None, a default title is used.</span>
<span class="sd">            alpha (float, optional): Alpha value for well colors. Default is 0.7.</span>
<span class="sd">            well_size (int, optional): Size of the wells in the figure. Default is 1200.</span>
<span class="sd">            fig_width (float, optional): Width of the figure. Default is 11.69.</span>
<span class="sd">            fig_height (float, optional): Height of the figure. Default is 8.27.</span>
<span class="sd">            dpi (int, optional): Dots per inch for the figure. Default is 100.</span>
<span class="sd">            plt_style (str, optional): Matplotlib style to use. Default is &#39;bmh&#39;.</span>
<span class="sd">            grid_color (tuple, optional): Color for the grid. Default is (1, 1, 1).</span>
<span class="sd">            edge_color (tuple, optional): Color for the edges of wells. Default is (0.5, 0.5, 0.5).</span>
<span class="sd">            legend_bb (tuple, optional): Bounding box for the legend. Default is (0.15, -0.15, 0.7, 1.3).</span>
<span class="sd">            legend_n_columns (int, optional): Number of columns in the legend. Default is 6.</span>
<span class="sd">            colormap (str, optional): Colormap name for coloring wells. Uses default colormap if None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            matplotlib.figure.Figure: A figure object representing the plate.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If provided metadata keys are not valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span> <span class="k">if</span> <span class="n">colormap</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_colormap</span>

        <span class="c1"># Validate metadata keys</span>
        <span class="k">if</span> <span class="n">color_metadata_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_metadata_key</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid color_metadata_key: </span><span class="si">{</span><span class="n">color_metadata_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">annotation_metadata_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_metadata_key</span><span class="p">(</span><span class="n">annotation_metadata_key</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid annotation_metadata_key: </span><span class="si">{</span><span class="n">annotation_metadata_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


        <span class="c1"># Define title</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title_str</span><span class="p">:</span>
            <span class="n">title_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">annotation_metadata_key</span> <span class="ow">or</span> <span class="n">color_metadata_key</span><span class="p">:</span>
                <span class="n">title_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, showing </span><span class="si">{</span><span class="n">annotation_metadata_key</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> colored by </span><span class="si">{</span><span class="n">color_metadata_key</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Assign colors to wells</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assign_well_color</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">,</span> <span class="n">colormap</span><span class="p">)</span>


        <span class="c1"># Prepare grid and data for plotting</span>
        <span class="n">minX</span><span class="p">,</span> <span class="n">maxX</span><span class="p">,</span> <span class="n">minY</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span><span class="o">*</span><span class="n">step</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">)</span><span class="o">*</span><span class="n">step</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span> <span class="n">maxX</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">minY</span><span class="p">,</span> <span class="n">maxY</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

        <span class="c1"># Generate grid with columns first (column-major format)</span>
        <span class="n">Xgrid</span><span class="p">,</span> <span class="n">Ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">size_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">)</span> <span class="o">*</span> <span class="n">well_size</span>

        <span class="n">well_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_as_numpy_array</span><span class="p">(</span><span class="s2">&quot;rgb_color&quot;</span><span class="p">)))</span>

        <span class="c1"># Plot setup</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">plt_style</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">,</span> <span class="n">Ygrid</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_grid</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">well_colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edge_color</span><span class="p">)</span>

        <span class="c1"># Annotations</span>
        <span class="k">if</span> <span class="n">annotation_metadata_key</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">x_i</span> <span class="o">=</span> <span class="n">Xgrid</span><span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span>
                <span class="n">y_i</span> <span class="o">=</span> <span class="n">Ygrid</span><span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span>
                <span class="n">annotation_label</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">annotation_metadata_key</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation_label</span><span class="p">,</span> <span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="n">y_i</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="c1"># Legends</span>
        <span class="k">if</span> <span class="n">color_metadata_key</span><span class="p">:</span>
            <span class="c1"># Get unique categories and their corresponding colors</span>
            <span class="n">unique_categories</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">))</span>
            <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> 
                            <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">unique_categories</span><span class="p">]</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">legend_bb</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelspacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="n">legend_n_columns</span><span class="p">)</span>

        <span class="c1"># Axis settings</span>
        <span class="c1"># Move x-axis ticks to the top</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span> 

        <span class="c1"># Adjust the axis limits to fit the plot tightly</span>
        <span class="c1"># Assuming &#39;step&#39; is the distance between wells</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minX</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxX</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">minY</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Set x and y tick labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Grid settings</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">grid_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">grid_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minX</span> <span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">maxX</span> <span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.035</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">minY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.02</span><span class="p">)</span>

        <span class="c1"># Set tick labels inside the plotting box</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

        <span class="c1"># Ugly but works to adjust label padding</span>
        <span class="n">TICK_PADDING</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">(),</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_minor_ticks</span><span class="p">()]</span>
        <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">(),</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_minor_ticks</span><span class="p">()]</span>

        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*</span><span class="n">xticks</span><span class="p">,</span> <span class="o">*</span><span class="n">yticks</span><span class="p">):</span>
                <span class="n">tick</span><span class="o">.</span><span class="n">set_pad</span><span class="p">(</span><span class="n">TICK_PADDING</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>

        <span class="c1"># Set the position and size of the rounded rectangle</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">minX</span><span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.03</span>  <span class="c1"># X-coordinate of the lower-left corner</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">minY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.04</span> <span class="c1"># Y-coordinate of the lower-left corner</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.975</span> <span class="c1"># Width of the rectangle</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.955</span>  <span class="c1"># Height of the rectangle</span>
        <span class="n">border_radius</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Radius of the rounded corners</span>

        <span class="n">edge_alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">line_width</span> <span class="o">=</span> <span class="mi">2</span>  

        <span class="c1"># Create a rounded rectangle</span>
        <span class="n">rounded_rectangle</span> <span class="o">=</span> <span class="n">FancyBboxPatch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;round, pad=</span><span class="si">{</span><span class="n">border_radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">edge_alpha</span><span class="p">),</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

        <span class="c1"># Add the rounded rectangle to the axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rounded_rectangle</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">file_format</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
                <span class="n">metadata_keys</span> <span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the plate data to a file in the specified format.</span>

<span class="sd">        The method supports various file formats such as CSV, TSV, and Excel. It allows </span>
<span class="sd">        selection of specific metadata keys to be included in the output. If no file path </span>
<span class="sd">        is specified, the file is saved in the current working directory with a default </span>
<span class="sd">        name based on the plate ID.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            file_path (str, optional): The path where the file will be saved. </span>
<span class="sd">                If not specified, the file is saved in the current working directory.</span>
<span class="sd">            file_format (str, optional): The format of the file (&#39;csv&#39;, &#39;tsv&#39;, &#39;xls&#39;).</span>
<span class="sd">            metadata_keys (list, optional): A list of metadata keys to include in the file. </span>
<span class="sd">                If empty, all metadata except those in _default_exclude_metadata are included.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If an unsupported file format is specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;plate_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">file_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;plate_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">/</span> <span class="n">file_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file_format</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing to file:</span><span class="se">\n\t</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metadata_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">metadata_keys</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># use all metadata except those in default_exclude_metadata</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_exclude_metadata</span><span class="p">)</span>

        <span class="k">match</span> <span class="n">file_format</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;tsv&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">case</span> <span class="s2">&quot;xls&quot;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add or update metadata for all wells in the plate. If a list of values is provided,</span>
<span class="sd">        assign each value to the corresponding well. If a single value is provided, assign it to all wells.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            key (str): The metadata key to add or update.</span>
<span class="sd">            values: A single value or a list of values to set for the given metadata key. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># Case when values is a list</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The length of values list does not match the number of wells&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">well</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
                <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Case when a single value is provided</span>
            <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
                <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">row_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the row labels for the plate.</span>

<span class="sd">        This property generates a list of alphabetical characters representing the row labels</span>
<span class="sd">        of the plate, based on the number of rows in the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of strings, each representing a row label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">column_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the column labels for the plate.</span>

<span class="sd">        This property generates a list of numerical strings representing the column labels</span>
<span class="sd">        of the plate, based on the number of columns in the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of strings, each representing a column label.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">row_id</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">row_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of samples that can be added to the plate, which is the same as the number of wells in this class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the plate ID.</span>

<span class="sd">        This property returns the unique identifier of the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The plate ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plate_id</span>

    <span class="nd">@plate_id</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new plate ID.</span>

<span class="sd">        This method updates the plate ID and propagates the change to all the wells </span>
<span class="sd">        within the plate.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            new_id (int): The new plate ID to be set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plate_id</span> <span class="o">=</span> <span class="n">new_id</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">well</span><span class="o">.</span><span class="n">plate_id</span> <span class="o">=</span> <span class="n">new_id</span>

    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">create_index_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Static method to create a list of index coordinates for the wells in a plate.</span>

<span class="sd">        The method generates a grid of coordinates, counting from left to right, </span>
<span class="sd">        starting at the well in the top left. It is used to map the wells to their </span>
<span class="sd">        respective positions in the plate.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            rows (iterable): An iterable representing the rows of the plate.</span>
<span class="sd">            columns (iterable): An iterable representing the columns of the plate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of tuples, each representing the (row, column) index of a well.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># count from left to right, starting at well in top left</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                                    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                                    <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
                                    <span class="p">)</span>
                <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_alphanumerical_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Static method to create alphanumerical coordinates for the wells.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            rows (list): A list of row indices.</span>
<span class="sd">            columns (list): A list of column indices.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of alphanumerical coordinates (e.g., &quot;A1&quot;, &quot;B2&quot;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">row_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row_labels</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="si">}{</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="src.plate.Plate.capacity" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">capacity</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the number of samples that can be added to the plate, which is the same as the number of wells in this class</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="src.plate.Plate.column_labels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">column_labels</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the column labels for the plate.</p>
<p>This property generates a list of numerical strings representing the column labels
of the plate, based on the number of columns in the plate.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of strings, each representing a column label.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="src.plate.Plate.plate_id" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plate_id</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the plate ID.</p>
<p>This property returns the unique identifier of the plate.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The plate ID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="src.plate.Plate.row_labels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">row_labels</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the row labels for the plate.</p>
<p>This property generates a list of alphabetical characters representing the row labels
of the plate, based on the number of rows in the plate.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of strings, each representing a row label.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.__getitem__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieve a well from the plate based on its index, coordinate, or name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>int, tuple, or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The identifier for the well. Can be an integer index, </p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Well</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The well object corresponding to the given key.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the key is not an integer, tuple, or string.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a well from the plate based on its index, coordinate, or name.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        key (int, tuple, or str): The identifier for the well. Can be an integer index, </span>
<span class="sd">        a tuple indicating row and column coordinates, or a string specifying the well&#39;s name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Well: The well object corresponding to the given key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the key is not an integer, tuple, or string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="c1"># Access by index</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="c1"># Access by coordinate</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates_to_index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Access by name</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Key must be an integer, tuple, or string&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">plate_dim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plate_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a new Plate instance.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>plate_dim</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The dimensions of the plate as (rows, columns).
If None, default dimensions are used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>plate_id</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A unique identifier for the plate.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>The constructor initializes the plate with the specified dimensions, generating wells 
with default properties and assigning them unique coordinates and identifiers.</p>



<p><strong>Examples:</strong></p>
    <p>Creating a Plate instance with default dimensions and a specific plate ID:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">plate</span> <span class="o">=</span> <span class="n">Plate</span><span class="p">(</span><span class="n">plate_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plate</span><span class="o">.</span><span class="n">size</span>  <span class="c1"># This will depend on the default number of rows and columns</span>
<span class="go">96  # Example output, assuming 8 rows x 12 columns</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plate_dim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">plate_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a new Plate instance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        plate_dim (Tuple[int, int], optional): The dimensions of the plate as (rows, columns).</span>
<span class="sd">            If None, default dimensions are used.</span>
<span class="sd">        plate_id (int, optional): A unique identifier for the plate.</span>

<span class="sd">    The constructor initializes the plate with the specified dimensions, generating wells </span>
<span class="sd">    with default properties and assigning them unique coordinates and identifiers.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Creating a Plate instance with default dimensions and a specific plate ID:</span>

<span class="sd">        &gt;&gt;&gt; plate = Plate(plate_id=1)</span>
<span class="sd">        &gt;&gt;&gt; plate.size  # This will depend on the default number of rows and columns</span>
<span class="sd">        96  # Example output, assuming 8 rows x 12 columns</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_plate_dimensions</span><span class="p">(</span><span class="n">plate_dim</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_alphanumerical_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_alphanumerical_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_index_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">wells</span> <span class="o">=</span> <span class="p">[</span><span class="n">Well</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_alphanumerical_coordinates</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> 
                       <span class="n">coordinate</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> 
                       <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> 
                       <span class="n">plate_id</span><span class="o">=</span><span class="n">plate_id</span><span class="p">,</span> 
                       <span class="n">rgb_color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">))]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span> <span class="o">=</span> <span class="n">plate_id</span>

    <span class="c1"># dictionary to map well names to indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_name_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">well</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">well</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">}</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="si">}</span><span class="s2"> plate with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> wells.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the number of wells in the plate.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of wells.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the number of wells in the plate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of wells.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.__setitem__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">well_object</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set or replace a well in the plate based on its index, coordinate, or name.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>int, tuple, or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The identifier for the well to be set or replaced. 
Can be an integer index, a tuple indicating row and column coordinates, or a string specifying the well's name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>well_object (Well): The well object to set at the specified key.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the well_object is not an instance of Well.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>IndexError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the well index is out of range.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the key is not a string, integer, or tuple.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">well_object</span><span class="p">:</span> <span class="n">Well</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set or replace a well in the plate based on its index, coordinate, or name.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        key (int, tuple, or str): The identifier for the well to be set or replaced. </span>
<span class="sd">            Can be an integer index, a tuple indicating row and column coordinates, or a string specifying the well&#39;s name.</span>
<span class="sd">    well_object (Well): The well object to set at the specified key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the well_object is not an instance of Well.</span>
<span class="sd">        IndexError: If the well index is out of range.</span>
<span class="sd">        TypeError: If the key is not a string, integer, or tuple.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">well_object</span><span class="p">,</span> <span class="n">Well</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Value must be an instance of Well&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Well index out of range&quot;</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_coordinates_map</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coordinates_to_index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">coordinate</span> <span class="o">=</span> <span class="n">key</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index_to_name_map</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Key must be a string, integer, or tuple&quot;</span><span class="p">)</span>

    <span class="c1"># Update the well object&#39;s attributes</span>
    <span class="n">well_object</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">well_object</span><span class="o">.</span><span class="n">coordinate</span> <span class="o">=</span> <span class="n">coordinate</span>
    <span class="n">well_object</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="n">well_object</span><span class="o">.</span><span class="n">plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span>

    <span class="c1"># Update the well at the specified index on the plate</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">well_object</span>
    <span class="c1"># Update the name-to-index mapping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name_to_index_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.add_metadata" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_metadata</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add or update metadata for all wells in the plate. If a list of values is provided,
assign each value to the corresponding well. If a single value is provided, assign it to all wells.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The metadata key to add or update.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>values</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A single value or a list of values to set for the given metadata key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add or update metadata for all wells in the plate. If a list of values is provided,</span>
<span class="sd">    assign each value to the corresponding well. If a single value is provided, assign it to all wells.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        key (str): The metadata key to add or update.</span>
<span class="sd">        values: A single value or a list of values to set for the given metadata key. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="c1"># Case when values is a list</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The length of values list does not match the number of wells&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">well</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Case when a single value is provided</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.as_dataframe" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_dataframe</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Converts the plate data into a Pandas DataFrame.</p>
<p>Each well and its attributes are represented as a row in the DataFrame.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pandas.DataFrame: A DataFrame representing the plate's wells and their attributes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the plate data into a Pandas DataFrame.</span>

<span class="sd">    Each well and its attributes are represented as a row in the DataFrame.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pandas.DataFrame: A DataFrame representing the plate&#39;s wells and their attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">as_records</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.as_figure" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_figure</span><span class="p">(</span><span class="n">annotation_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">well_size</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">fig_width</span><span class="o">=</span><span class="mf">11.69</span><span class="p">,</span> <span class="n">fig_height</span><span class="o">=</span><span class="mf">8.27</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">plt_style</span><span class="o">=</span><span class="s1">&#39;bmh&#39;</span><span class="p">,</span> <span class="n">grid_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">edge_color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">legend_bb</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="n">legend_n_columns</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Create a visual representation of the plate using matplotlib.</p>
<p>This method generates a figure representing the plate, with options for annotations,
coloring based on metadata, and various styling adjustments.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>annotation_metadata_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Metadata key to use for annotating wells.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>color_metadata_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Metadata key to determine the color of wells.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fontsize</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Font size for annotations. Default is 8.</p>
            </div>
          </td>
          <td>
                <code>8</code>
          </td>
        </tr>
        <tr>
          <td><code>rotation</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Rotation angle for annotations. Default is 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>step</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Step size between wells in the grid. Default is 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>title_str</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Title of the figure. If None, a default title is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Alpha value for well colors. Default is 0.7.</p>
            </div>
          </td>
          <td>
                <code>0.7</code>
          </td>
        </tr>
        <tr>
          <td><code>well_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of the wells in the figure. Default is 1200.</p>
            </div>
          </td>
          <td>
                <code>1200</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_width</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of the figure. Default is 11.69.</p>
            </div>
          </td>
          <td>
                <code>11.69</code>
          </td>
        </tr>
        <tr>
          <td><code>fig_height</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Height of the figure. Default is 8.27.</p>
            </div>
          </td>
          <td>
                <code>8.27</code>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dots per inch for the figure. Default is 100.</p>
            </div>
          </td>
          <td>
                <code>100</code>
          </td>
        </tr>
        <tr>
          <td><code>plt_style</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Matplotlib style to use. Default is 'bmh'.</p>
            </div>
          </td>
          <td>
                <code>&#39;bmh&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>grid_color</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color for the grid. Default is (1, 1, 1).</p>
            </div>
          </td>
          <td>
                <code>(1, 1, 1)</code>
          </td>
        </tr>
        <tr>
          <td><code>edge_color</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Color for the edges of wells. Default is (0.5, 0.5, 0.5).</p>
            </div>
          </td>
          <td>
                <code>(0.5, 0.5, 0.5)</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_bb</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Bounding box for the legend. Default is (0.15, -0.15, 0.7, 1.3).</p>
            </div>
          </td>
          <td>
                <code>(0.15, -0.15, 0.7, 1.3)</code>
          </td>
        </tr>
        <tr>
          <td><code>legend_n_columns</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of columns in the legend. Default is 6.</p>
            </div>
          </td>
          <td>
                <code>6</code>
          </td>
        </tr>
        <tr>
          <td><code>colormap</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Colormap name for coloring wells. Uses default colormap if None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>matplotlib.figure.Figure: A figure object representing the plate.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If provided metadata keys are not valid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">annotation_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
              <span class="n">color_metadata_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
              <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
              <span class="n">title_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
              <span class="n">well_size</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span>
              <span class="n">fig_width</span><span class="o">=</span><span class="mf">11.69</span><span class="p">,</span>
              <span class="n">fig_height</span><span class="o">=</span><span class="mf">8.27</span><span class="p">,</span>
              <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
              <span class="n">plt_style</span><span class="o">=</span><span class="s2">&quot;bmh&quot;</span><span class="p">,</span>
              <span class="n">grid_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
              <span class="n">edge_color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
              <span class="n">legend_bb</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span>
              <span class="n">legend_n_columns</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
              <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a visual representation of the plate using matplotlib.</span>

<span class="sd">    This method generates a figure representing the plate, with options for annotations,</span>
<span class="sd">    coloring based on metadata, and various styling adjustments.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        annotation_metadata_key (str, optional): Metadata key to use for annotating wells.</span>
<span class="sd">        color_metadata_key (str, optional): Metadata key to determine the color of wells.</span>
<span class="sd">        fontsize (int, optional): Font size for annotations. Default is 8.</span>
<span class="sd">        rotation (int, optional): Rotation angle for annotations. Default is 0.</span>
<span class="sd">        step (int, optional): Step size between wells in the grid. Default is 10.</span>
<span class="sd">        title_str (str, optional): Title of the figure. If None, a default title is used.</span>
<span class="sd">        alpha (float, optional): Alpha value for well colors. Default is 0.7.</span>
<span class="sd">        well_size (int, optional): Size of the wells in the figure. Default is 1200.</span>
<span class="sd">        fig_width (float, optional): Width of the figure. Default is 11.69.</span>
<span class="sd">        fig_height (float, optional): Height of the figure. Default is 8.27.</span>
<span class="sd">        dpi (int, optional): Dots per inch for the figure. Default is 100.</span>
<span class="sd">        plt_style (str, optional): Matplotlib style to use. Default is &#39;bmh&#39;.</span>
<span class="sd">        grid_color (tuple, optional): Color for the grid. Default is (1, 1, 1).</span>
<span class="sd">        edge_color (tuple, optional): Color for the edges of wells. Default is (0.5, 0.5, 0.5).</span>
<span class="sd">        legend_bb (tuple, optional): Bounding box for the legend. Default is (0.15, -0.15, 0.7, 1.3).</span>
<span class="sd">        legend_n_columns (int, optional): Number of columns in the legend. Default is 6.</span>
<span class="sd">        colormap (str, optional): Colormap name for coloring wells. Uses default colormap if None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        matplotlib.figure.Figure: A figure object representing the plate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If provided metadata keys are not valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colormap</span> <span class="o">=</span> <span class="n">colormap</span> <span class="k">if</span> <span class="n">colormap</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_colormap</span>

    <span class="c1"># Validate metadata keys</span>
    <span class="k">if</span> <span class="n">color_metadata_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_metadata_key</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid color_metadata_key: </span><span class="si">{</span><span class="n">color_metadata_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">annotation_metadata_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_metadata_key</span><span class="p">(</span><span class="n">annotation_metadata_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid annotation_metadata_key: </span><span class="si">{</span><span class="n">annotation_metadata_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># Define title</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">title_str</span><span class="p">:</span>
        <span class="n">title_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Plate </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">annotation_metadata_key</span> <span class="ow">or</span> <span class="n">color_metadata_key</span><span class="p">:</span>
            <span class="n">title_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, showing </span><span class="si">{</span><span class="n">annotation_metadata_key</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> colored by </span><span class="si">{</span><span class="n">color_metadata_key</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Assign colors to wells</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">assign_well_color</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">,</span> <span class="n">colormap</span><span class="p">)</span>


    <span class="c1"># Prepare grid and data for plotting</span>
    <span class="n">minX</span><span class="p">,</span> <span class="n">maxX</span><span class="p">,</span> <span class="n">minY</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span><span class="o">*</span><span class="n">step</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">)</span><span class="o">*</span><span class="n">step</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">minX</span><span class="p">,</span> <span class="n">maxX</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">minY</span><span class="p">,</span> <span class="n">maxY</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

    <span class="c1"># Generate grid with columns first (column-major format)</span>
    <span class="n">Xgrid</span><span class="p">,</span> <span class="n">Ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">size_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">)</span> <span class="o">*</span> <span class="n">well_size</span>

    <span class="n">well_colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_as_numpy_array</span><span class="p">(</span><span class="s2">&quot;rgb_color&quot;</span><span class="p">)))</span>

    <span class="c1"># Plot setup</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">plt_style</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_width</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Xgrid</span><span class="p">,</span> <span class="n">Ygrid</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_grid</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">well_colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">edge_color</span><span class="p">)</span>

    <span class="c1"># Annotations</span>
    <span class="k">if</span> <span class="n">annotation_metadata_key</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">x_i</span> <span class="o">=</span> <span class="n">Xgrid</span><span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span>
            <span class="n">y_i</span> <span class="o">=</span> <span class="n">Ygrid</span><span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span>
            <span class="n">annotation_label</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">annotation_metadata_key</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">annotation_label</span><span class="p">,</span> <span class="p">(</span><span class="n">x_i</span><span class="p">,</span> <span class="n">y_i</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="c1"># Legends</span>
    <span class="k">if</span> <span class="n">color_metadata_key</span><span class="p">:</span>
        <span class="c1"># Get unique categories and their corresponding colors</span>
        <span class="n">unique_categories</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">color_metadata_key</span><span class="p">))</span>
        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">category</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> 
                        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">unique_categories</span><span class="p">]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_handles</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">legend_bb</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelspacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="n">legend_n_columns</span><span class="p">)</span>

    <span class="c1"># Axis settings</span>
    <span class="c1"># Move x-axis ticks to the top</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_top</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">)</span> 

    <span class="c1"># Adjust the axis limits to fit the plot tightly</span>
    <span class="c1"># Assuming &#39;step&#39; is the distance between wells</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minX</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxX</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">minY</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">-</span> <span class="n">step</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Set x and y tick labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">row_labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Grid settings</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">grid_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">grid_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">minX</span> <span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">maxX</span> <span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.035</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">minY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">maxY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.02</span><span class="p">)</span>

    <span class="c1"># Set tick labels inside the plotting box</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>

    <span class="c1"># Ugly but works to adjust label padding</span>
    <span class="n">TICK_PADDING</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">(),</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_minor_ticks</span><span class="p">()]</span>
    <span class="n">yticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">(),</span> <span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_minor_ticks</span><span class="p">()]</span>

    <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="p">(</span><span class="o">*</span><span class="n">xticks</span><span class="p">,</span> <span class="o">*</span><span class="n">yticks</span><span class="p">):</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">set_pad</span><span class="p">(</span><span class="n">TICK_PADDING</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_str</span><span class="p">)</span>

    <span class="c1"># Set the position and size of the rounded rectangle</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">minX</span><span class="o">-</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.03</span>  <span class="c1"># X-coordinate of the lower-left corner</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">minY</span> <span class="o">-</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.04</span> <span class="c1"># Y-coordinate of the lower-left corner</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">maxX</span><span class="o">*</span><span class="mf">0.975</span> <span class="c1"># Width of the rectangle</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">maxY</span><span class="o">*</span><span class="mf">0.955</span>  <span class="c1"># Height of the rectangle</span>
    <span class="n">border_radius</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Radius of the rounded corners</span>

    <span class="n">edge_alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">line_width</span> <span class="o">=</span> <span class="mi">2</span>  

    <span class="c1"># Create a rounded rectangle</span>
    <span class="n">rounded_rectangle</span> <span class="o">=</span> <span class="n">FancyBboxPatch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;round, pad=</span><span class="si">{</span><span class="n">border_radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">line_width</span><span class="p">,</span><span class="n">ec</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">edge_alpha</span><span class="p">),</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

    <span class="c1"># Add the rounded rectangle to the axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rounded_rectangle</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.as_records" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_records</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert the plate's well data into a list of dictionaries.</p>
<p>Each well's attributes are converted into a dictionary, and all these dictionaries
are compiled into a list, with one dictionary per well.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of dict: A list where each element is a dictionary representing a well's attributes.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_records</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the plate&#39;s well data into a list of dictionaries.</span>

<span class="sd">    Each well&#39;s attributes are converted into a dictionary, and all these dictionaries</span>
<span class="sd">    are compiled into a list, with one dictionary per well.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of dict: A list where each element is a dictionary representing a well&#39;s attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">well</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.assign_well_color" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">assign_well_color</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">,</span> <span class="n">colormap</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Assign colors to each well in the plate based on the specified metadata key and colormap.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metadata_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The metadata key to use for coloring the wells. 
If None, a default color is assigned to each well.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>colormap (str): The name of the colormap to use for coloring the wells.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the metadata_key is invalid or not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assign_well_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">colormap</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign colors to each well in the plate based on the specified metadata key and colormap.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        metadata_key (str, optional): The metadata key to use for coloring the wells. </span>
<span class="sd">            If None, a default color is assigned to each well.</span>
<span class="sd">    colormap (str): The name of the colormap to use for coloring the wells.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the metadata_key is invalid or not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">colormap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_colormap</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">metadata_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">metadata_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
        <span class="n">unique_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">metadata_values</span><span class="p">)</span>

        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
        <span class="n">color_norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_values</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">scalar_map</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">color_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;NaN&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="n">scalar_map</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># RGB color</span>

        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">metadata_value</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
            <span class="n">well</span><span class="o">.</span><span class="n">rgb_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata_color_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">metadata_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Assign default color when metadata_key is None</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">well</span><span class="o">.</span><span class="n">rgb_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_well_color</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.create_alphanumerical_coordinates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_alphanumerical_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Static method to create alphanumerical coordinates for the wells.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rows</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of row indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>columns</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of column indices.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of alphanumerical coordinates (e.g., "A1", "B2").</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_alphanumerical_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Static method to create alphanumerical coordinates for the wells.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        rows (list): A list of row indices.</span>
<span class="sd">        columns (list): A list of column indices.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of alphanumerical coordinates (e.g., &quot;A1&quot;, &quot;B2&quot;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">row_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
    <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row_labels</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="si">}{</span><span class="n">col</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.create_index_coordinates" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_index_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Static method to create a list of index coordinates for the wells in a plate.</p>
<p>The method generates a grid of coordinates, counting from left to right, 
starting at the well in the top left. It is used to map the wells to their 
respective positions in the plate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>rows</code></td>
          <td>
                <code>iterable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An iterable representing the rows of the plate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>columns</code></td>
          <td>
                <code>iterable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An iterable representing the columns of the plate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of tuples, each representing the (row, column) index of a well.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>    
<span class="k">def</span> <span class="nf">create_index_coordinates</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Static method to create a list of index coordinates for the wells in a plate.</span>

<span class="sd">    The method generates a grid of coordinates, counting from left to right, </span>
<span class="sd">    starting at the well in the top left. It is used to map the wells to their </span>
<span class="sd">    respective positions in the plate.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        rows (iterable): An iterable representing the rows of the plate.</span>
<span class="sd">        columns (iterable): An iterable representing the columns of the plate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of tuples, each representing the (row, column) index of a well.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># count from left to right, starting at well in top left</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                                <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                                <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">))</span>
                                <span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.get_metadata" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieve metadata values for all wells in the plate based on the specified key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metadata_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The metadata key for which values are to be retrieved. 
If None, a default value of 'NaN' is returned for each well.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of metadata values for each well in the plate.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve metadata values for all wells in the plate based on the specified key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        metadata_key (str, optional): The metadata key for which values are to be retrieved. </span>
<span class="sd">            If None, a default value of &#39;NaN&#39; is returned for each well.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of metadata values for each well in the plate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">metadata_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;NaN&quot;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">]</span>

    <span class="n">metadata_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">well</span><span class="o">.</span><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
        <span class="n">metadata_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">metadata_values</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.get_metadata_as_numpy_array" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_metadata_as_numpy_array</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Retrieve metadata values for all wells in a numpy array format based on the specified key.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>metadata_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The metadata key for which values are to be retrieved.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray: A numpy array representing the metadata values for the plate's layout.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_metadata_as_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata_key</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve metadata values for all wells in a numpy array format based on the specified key.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        metadata_key (str): The metadata key for which values are to be retrieved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: A numpy array representing the metadata values for the plate&#39;s layout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="n">metadata_key</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_numpy_array</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.is_valid_metadata_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_valid_metadata_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Check if the provided key is a valid metadata key for the Well instances in the plate.</p>
<p>This method verifies whether the specified key is either a direct attribute of the Well instances
or a key within their metadata dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The key to check for validity as a metadata key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if the key is a valid metadata key, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_metadata_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if the provided key is a valid metadata key for the Well instances in the plate.</span>

<span class="sd">    This method verifies whether the specified key is either a direct attribute of the Well instances</span>
<span class="sd">    or a key within their metadata dictionary.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        key (str): The key to check for validity as a metadata key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the key is a valid metadata key, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>  <span class="c1"># If key is None or empty</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Check if the key is a direct attribute or in the metadata dictionary of any well</span>
    <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">well</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Plate.to_file" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_file</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="n">metadata_keys</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write the plate data to a file in the specified format.</p>
<p>The method supports various file formats such as CSV, TSV, and Excel. It allows 
selection of specific metadata keys to be included in the output. If no file path 
is specified, the file is saved in the current working directory with a default 
name based on the plate ID.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path where the file will be saved. 
If not specified, the file is saved in the current working directory.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>file_format</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The format of the file ('csv', 'tsv', 'xls').</p>
            </div>
          </td>
          <td>
                <code>&#39;csv&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>metadata_keys</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of metadata keys to include in the file. 
If empty, all metadata except those in _default_exclude_metadata are included.</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If an unsupported file format is specified.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">file_format</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
            <span class="n">metadata_keys</span> <span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write the plate data to a file in the specified format.</span>

<span class="sd">    The method supports various file formats such as CSV, TSV, and Excel. It allows </span>
<span class="sd">    selection of specific metadata keys to be included in the output. If no file path </span>
<span class="sd">    is specified, the file is saved in the current working directory with a default </span>
<span class="sd">    name based on the plate ID.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        file_path (str, optional): The path where the file will be saved. </span>
<span class="sd">            If not specified, the file is saved in the current working directory.</span>
<span class="sd">        file_format (str, optional): The format of the file (&#39;csv&#39;, &#39;tsv&#39;, &#39;xls&#39;).</span>
<span class="sd">        metadata_keys (list, optional): A list of metadata keys to include in the file. </span>
<span class="sd">            If empty, all metadata except those in _default_exclude_metadata are included.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If an unsupported file format is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;plate_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">file_name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;plate_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">/</span> <span class="n">file_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_format</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Writing to file:</span><span class="se">\n\t</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">metadata_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">metadata_keys</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># use all metadata except those in default_exclude_metadata</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_exclude_metadata</span><span class="p">)</span>

    <span class="k">match</span> <span class="n">file_format</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;tsv&quot;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">case</span> <span class="s2">&quot;xls&quot;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="src.plate.QCPlate" class="doc doc-heading">
          <code>QCPlate</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="src.plate.Plate" href="#src.plate.Plate">Plate</a></code></p>

  
      <p><em>summary</em>
Class that represents a multiwell plate where some wells can 
contain quality control samples according to the scheme defined 
in QC_config; either a <config_file.toml> file or a dict following the same structure</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>Plate</code></td>
          <td>
                <code>_type_</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><em>description</em></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>src/plate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">QCPlate</span><span class="p">(</span><span class="n">Plate</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;_summary_</span>
<span class="sd">    Class that represents a multiwell plate where some wells can </span>
<span class="sd">    contain quality control samples according to the scheme defined </span>
<span class="sd">    in QC_config; either a &lt;config_file.toml&gt; file or a dict following the same structure</span>

<span class="sd">    Args:</span>
<span class="sd">        Plate (_type_): _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_non_qc_sample_code</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
    <span class="n">_non_qc_sample_name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Specimen&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">QC_config</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">QC_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">QC_config</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">QC_config</span>
            <span class="k">else</span><span class="p">:</span>                                        
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_config_file</span><span class="p">(</span><span class="n">QC_config</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">create_QC_plate_layout</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No scheme for QC samples provided.&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">((</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">)</span><span class="si">}</span><span class="s2">), plate_id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">plate_summary</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Plate ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_id</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Dimensions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_rows</span><span class="si">}</span><span class="s2"> rows x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_columns</span><span class="si">}</span><span class="s2"> columns</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="s2">&quot;Plate Layout (Sample Codes):</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">plate_array_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_metadata_as_numpy_array</span><span class="p">(</span><span class="s2">&quot;sample_code&quot;</span><span class="p">))</span>
        <span class="n">plate_summary</span> <span class="o">+=</span> <span class="n">plate_array_str</span>
        <span class="k">return</span> <span class="n">plate_summary</span>

    <span class="k">def</span> <span class="nf">define_unique_QC_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Sets up the unique QC sequences for each round based on the new config structure. &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Setting up dynamic QC scheme from config file&quot;</span><span class="p">)</span>

        <span class="c1"># Initialize variables</span>
        <span class="n">total_wells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">qc_round_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;run_QC_after_n_specimens&#39;</span><span class="p">]</span>
        <span class="n">max_rounds</span> <span class="o">=</span> <span class="n">total_wells</span> <span class="o">//</span> <span class="n">qc_round_frequency</span>

        <span class="c1"># Step 1: Initialize sequence map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">round_num</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>

        <span class="c1"># Step 2: Apply specific round patterns</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;round_&#39;</span><span class="p">):</span>
                <span class="n">round_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># Step 3: Apply start/end patterns</span>
        <span class="k">if</span> <span class="s1">&#39;start&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;end&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">max_rounds</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;end&#39;</span><span class="p">]</span>

        <span class="c1"># Step 4: Apply repeat pattern</span>
        <span class="k">if</span> <span class="s1">&#39;repeat_pattern&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
            <span class="n">repeat_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;repeat_pattern&#39;</span><span class="p">]</span>
            <span class="n">pattern</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">repeat_config</span><span class="p">[</span><span class="s1">&#39;pattern&#39;</span><span class="p">],</span> <span class="n">repeat_config</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">times</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern</span>

        <span class="c1"># Step 5: Apply alternating patterns</span>
        <span class="k">if</span> <span class="s1">&#39;then_alternating&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
            <span class="n">alternating_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;then_alternating&#39;</span><span class="p">]</span>
            <span class="n">alt_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">alternating_patterns</span><span class="p">[</span><span class="n">alt_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">alternating_patterns</span><span class="p">)]</span>
                    <span class="n">alt_index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Step 6: Apply every N rounds patterns</span>
        <span class="n">every_n_patterns</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;every_&#39;</span><span class="p">)}</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">every_n_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Correctly extract the frequency (e.g., 4 in &#39;every_4_rounds&#39;)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">frequency</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">key</span><span class="p">)))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid frequency format in pattern key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">round_num</span> <span class="o">%</span> <span class="n">frequency</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern</span>

        <span class="c1"># Log the defined sequences</span>
        <span class="k">for</span> <span class="n">round_number</span><span class="p">,</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="n">round_number</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_QC_plate_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Creates the plate layout with QC and specimen samples. &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating dynamic plate layout with QC samples.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">define_unique_QC_sequences</span><span class="p">()</span>

        <span class="c1"># Initialize counters for QC sample types</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">qc_type</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">qc_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">][</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

        <span class="n">round_counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">specimen_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">qc_round_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;run_QC_after_n_specimens&#39;</span><span class="p">]</span>
        <span class="n">start_with_qc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;start_with_QC_round&#39;</span><span class="p">]</span>
        <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>

        <span class="k">for</span> <span class="n">well_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">start_with_qc</span> <span class="ow">and</span> <span class="n">round_counter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Place QC samples for the first round</span>
                    <span class="n">qc_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">current_round_qc_samples</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assign_qc_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">qc_sample</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">round_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>

            <span class="k">if</span> <span class="n">specimen_counter</span> <span class="o">&gt;=</span> <span class="n">qc_round_frequency</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">qc_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">current_round_qc_samples</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assign_qc_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">qc_sample</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                    <span class="n">round_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">specimen_counter</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">assign_specimen_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">specimen_counter</span><span class="p">)</span>
                    <span class="n">specimen_counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assign_specimen_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">specimen_counter</span><span class="p">)</span>
                <span class="n">specimen_counter</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Log the final layout</span>
        <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Well </span><span class="si">{</span><span class="n">well</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">assign_qc_sample_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">well_index</span><span class="p">,</span> <span class="n">qc_sample</span><span class="p">,</span> <span class="n">counts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">sample_code</span> <span class="o">=</span> <span class="n">qc_sample</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">sample_code</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">][</span><span class="s2">&quot;names&quot;</span><span class="p">][</span><span class="n">sample_code</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sample_code</span><span class="si">}{</span><span class="n">counts</span><span class="p">[</span><span class="n">sample_code</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">assign_specimen_sample_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">well_index</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_qc_sample_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_qc_sample_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">[</span><span class="n">well_index</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_non_qc_sample_code</span><span class="si">}{</span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># number of non-QC samples that can be added to the plate - TODO change name?</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="ow">not</span> <span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_config_file</span><span class="p">(</span><span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>

        <span class="c1"># READ CONFIG FILE</span>
        <span class="k">if</span> <span class="n">config_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No config file specified. Trying to find a toml file in current folder.&quot;</span><span class="p">)</span>

            <span class="n">config_file_search</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.toml&quot;</span><span class="p">)</span>      

            <span class="k">if</span> <span class="n">config_file_search</span><span class="p">:</span>
                <span class="n">config_file</span> <span class="o">=</span> <span class="n">config_file_search</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using toml file &#39;</span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">tomli</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully loaded config file </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">config</span>

        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not find/open config file </span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>            
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="src.plate.QCPlate.create_QC_plate_layout" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_QC_plate_layout</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Creates the plate layout with QC and specimen samples.</p>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_QC_plate_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Creates the plate layout with QC and specimen samples. &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating dynamic plate layout with QC samples.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">define_unique_QC_sequences</span><span class="p">()</span>

    <span class="c1"># Initialize counters for QC sample types</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">qc_type</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">qc_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">][</span><span class="s2">&quot;names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

    <span class="n">round_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">specimen_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">qc_round_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;run_QC_after_n_specimens&#39;</span><span class="p">]</span>
    <span class="n">start_with_qc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;start_with_QC_round&#39;</span><span class="p">]</span>
    <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="k">for</span> <span class="n">well_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">start_with_qc</span> <span class="ow">and</span> <span class="n">round_counter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Place QC samples for the first round</span>
                <span class="n">qc_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">current_round_qc_samples</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assign_qc_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">qc_sample</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">round_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>

        <span class="k">if</span> <span class="n">specimen_counter</span> <span class="o">&gt;=</span> <span class="n">qc_round_frequency</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">qc_sample</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">current_round_qc_samples</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assign_qc_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">qc_sample</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="n">round_counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">specimen_counter</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">current_round_qc_samples</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">round_counter</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">assign_specimen_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">specimen_counter</span><span class="p">)</span>
                <span class="n">specimen_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assign_specimen_sample_metadata</span><span class="p">(</span><span class="n">well_index</span><span class="p">,</span> <span class="n">specimen_counter</span><span class="p">)</span>
            <span class="n">specimen_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Log the final layout</span>
    <span class="k">for</span> <span class="n">well</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wells</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Well </span><span class="si">{</span><span class="n">well</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">well</span><span class="o">.</span><span class="n">metadata</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.QCPlate.define_unique_QC_sequences" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">define_unique_QC_sequences</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets up the unique QC sequences for each round based on the new config structure.</p>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">define_unique_QC_sequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sets up the unique QC sequences for each round based on the new config structure. &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Setting up dynamic QC scheme from config file&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize variables</span>
    <span class="n">total_wells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
    <span class="n">qc_round_frequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;run_QC_after_n_specimens&#39;</span><span class="p">]</span>
    <span class="n">max_rounds</span> <span class="o">=</span> <span class="n">total_wells</span> <span class="o">//</span> <span class="n">qc_round_frequency</span>

    <span class="c1"># Step 1: Initialize sequence map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">round_num</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>

    <span class="c1"># Step 2: Apply specific round patterns</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;round_&#39;</span><span class="p">):</span>
            <span class="n">round_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Step 3: Apply start/end patterns</span>
    <span class="k">if</span> <span class="s1">&#39;start&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;end&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">max_rounds</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;end&#39;</span><span class="p">]</span>

    <span class="c1"># Step 4: Apply repeat pattern</span>
    <span class="k">if</span> <span class="s1">&#39;repeat_pattern&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
        <span class="n">repeat_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;repeat_pattern&#39;</span><span class="p">]</span>
        <span class="n">pattern</span><span class="p">,</span> <span class="n">times</span> <span class="o">=</span> <span class="n">repeat_config</span><span class="p">[</span><span class="s1">&#39;pattern&#39;</span><span class="p">],</span> <span class="n">repeat_config</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">times</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern</span>

    <span class="c1"># Step 5: Apply alternating patterns</span>
    <span class="k">if</span> <span class="s1">&#39;then_alternating&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]:</span>
        <span class="n">alternating_patterns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">][</span><span class="s1">&#39;then_alternating&#39;</span><span class="p">]</span>
        <span class="n">alt_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">alternating_patterns</span><span class="p">[</span><span class="n">alt_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">alternating_patterns</span><span class="p">)]</span>
                <span class="n">alt_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Step 6: Apply every N rounds patterns</span>
    <span class="n">every_n_patterns</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;QC&#39;</span><span class="p">][</span><span class="s1">&#39;patterns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;every_&#39;</span><span class="p">)}</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">every_n_patterns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Correctly extract the frequency (e.g., 4 in &#39;every_4_rounds&#39;)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">frequency</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">isdigit</span><span class="p">,</span> <span class="n">key</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid frequency format in pattern key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">for</span> <span class="n">round_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_rounds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">round_num</span> <span class="o">%</span> <span class="n">frequency</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="p">[</span><span class="n">round_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">pattern</span>

    <span class="c1"># Log the defined sequences</span>
    <span class="k">for</span> <span class="n">round_number</span><span class="p">,</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qc_sequence_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="n">round_number</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="src.plate.Well" class="doc doc-heading">
          <code>Well</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">

  
      <p>A class to represent a well in a multiwell plate.</p>
<p>This class provides functionalities to represent and manipulate the properties 
of a well, including its name, plate ID, coordinate, index, color, and metadata.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="src.plate.Well.name">name</span></code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the well (default: "A1").</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Well.plate_id">plate_id</span></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The ID of the plate the well belongs to (default: 1).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Well.coordinate">coordinate</span></code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The (row, column) coordinate of the well in the plate (default: (0, 0)).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Well.index">index</span></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The index of the well (optional).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Well.rgb_color">rgb_color</span></code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[float, float, float]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The RGB color representation of the well (default: (1, 1, 1)).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="src.plate.Well.metadata">metadata</span></code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional metadata for the well (default: empty dictionary).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>well = Well(name="B2", plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5),)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>src/plate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Well</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to represent a well in a multiwell plate.</span>

<span class="sd">    This class provides functionalities to represent and manipulate the properties </span>
<span class="sd">    of a well, including its name, plate ID, coordinate, index, color, and metadata.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        name (str): The name of the well (default: &quot;A1&quot;).</span>
<span class="sd">        plate_id (int): The ID of the plate the well belongs to (default: 1).</span>
<span class="sd">        coordinate (Tuple[int, int]): The (row, column) coordinate of the well in the plate (default: (0, 0)).</span>
<span class="sd">        index (int): The index of the well (optional).</span>
<span class="sd">        rgb_color (Tuple[float, float, float]): The RGB color representation of the well (default: (1, 1, 1)).</span>
<span class="sd">        metadata (Dict[str, Any]): Additional metadata for the well (default: empty dictionary).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; well = Well(name=&quot;B2&quot;, plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5),)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;A1&quot;</span>
    <span class="n">plate_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">coordinate</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rgb_color</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the well object to a dictionary.</span>

<span class="sd">        The method returns a dictionary representation of the well object with the </span>
<span class="sd">        direct attributes of the well and the keys in the metadata attribute.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary representation of the well object.</span>

<span class="sd">        Example:</span>
<span class="sd">            Convert a Well instance to a dictionary:</span>
<span class="sd">            &gt;&gt;&gt; well = Well(name=&quot;B2&quot;, plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))</span>
<span class="sd">            &gt;&gt;&gt; well_dict = well.as_dict()</span>
<span class="sd">            &gt;&gt;&gt; print(well_dict)</span>
<span class="sd">            {&#39;name&#39;: &#39;B2&#39;, &#39;plate_id&#39;: 2, &#39;coordinate&#39;: (1, 1), &#39;index&#39;: 5, &#39;rgb_color&#39;: (0.5, 0.5, 0.5)}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attrib_dict</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">attrib_dict</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
        <span class="n">attrib_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">attrib_dict</span>

    <span class="k">def</span> <span class="nf">get_attribute_or_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the value of a direct attribute or a key in the metadata dictionary.</span>

<span class="sd">        This method first checks if the provided key corresponds to a direct </span>
<span class="sd">        attribute of the well object. If not, it then checks if the key exists </span>
<span class="sd">        in the metadata dictionary.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            key (str): The attribute name or metadata key.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The value of the attribute or metadata key, if found. Returns &#39;NaN&#39; if not found.</span>

<span class="sd">        Example:</span>
<span class="sd">        # Retrieve attribute and metadata values from a Well instance:</span>
<span class="sd">        &gt;&gt;&gt; well = Well(name=&quot;B2&quot;, plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))</span>
<span class="sd">        &gt;&gt;&gt; well.metadata = {&quot;sample_type&quot;: &quot;plasma&quot;}    </span>
<span class="sd">        &gt;&gt;&gt; well.get_attribute_or_metadata(&quot;plate_id&quot;)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; well.get_attribute_or_metadata(&quot;sample_type&quot;)</span>
<span class="sd">        &#39;plasma&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if it&#39;s a direct attribute</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;NaN&quot;</span><span class="p">)</span>
            <span class="c1"># return getattr(self, key, &quot;&quot;)</span>

        <span class="c1"># Check if it&#39;s a key in metadata</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;NaN&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="src.plate.Well.as_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_dict</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Converts the well object to a dictionary.</p>
<p>The method returns a dictionary representation of the well object with the 
direct attributes of the well and the keys in the metadata attribute.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary representation of the well object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <p>Convert a Well instance to a dictionary:</p>
<blockquote>
<blockquote>
<blockquote>
<p>well = Well(name="B2", plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))
well_dict = well.as_dict()
print(well_dict)
{'name': 'B2', 'plate_id': 2, 'coordinate': (1, 1), 'index': 5, 'rgb_color': (0.5, 0.5, 0.5)}</p>
</blockquote>
</blockquote>
</blockquote>
</details>
          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the well object to a dictionary.</span>

<span class="sd">    The method returns a dictionary representation of the well object with the </span>
<span class="sd">    direct attributes of the well and the keys in the metadata attribute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary representation of the well object.</span>

<span class="sd">    Example:</span>
<span class="sd">        Convert a Well instance to a dictionary:</span>
<span class="sd">        &gt;&gt;&gt; well = Well(name=&quot;B2&quot;, plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))</span>
<span class="sd">        &gt;&gt;&gt; well_dict = well.as_dict()</span>
<span class="sd">        &gt;&gt;&gt; print(well_dict)</span>
<span class="sd">        {&#39;name&#39;: &#39;B2&#39;, &#39;plate_id&#39;: 2, &#39;coordinate&#39;: (1, 1), &#39;index&#39;: 5, &#39;rgb_color&#39;: (0.5, 0.5, 0.5)}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrib_dict</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">attrib_dict</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
    <span class="n">attrib_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">attrib_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="src.plate.Well.get_attribute_or_metadata" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_attribute_or_metadata</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Get the value of a direct attribute or a key in the metadata dictionary.</p>
<p>This method first checks if the provided key corresponds to a direct 
attribute of the well object. If not, it then checks if the key exists 
in the metadata dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attribute name or metadata key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Any</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The value of the attribute or metadata key, if found. Returns 'NaN' if not found.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<h4 id="src.plate.Well.get_attribute_or_metadata--retrieve-attribute-and-metadata-values-from-a-well-instance">Retrieve attribute and metadata values from a Well instance:</h4>
<blockquote>
<blockquote>
<blockquote>
<p>well = Well(name="B2", plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))
well.metadata = {"sample_type": "plasma"}  <br />
well.get_attribute_or_metadata("plate_id")
2
well.get_attribute_or_metadata("sample_type")
'plasma'</p>
</blockquote>
</blockquote>
</blockquote>

          <details class="quote">
            <summary>Source code in <code>src/plate.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_attribute_or_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the value of a direct attribute or a key in the metadata dictionary.</span>

<span class="sd">    This method first checks if the provided key corresponds to a direct </span>
<span class="sd">    attribute of the well object. If not, it then checks if the key exists </span>
<span class="sd">    in the metadata dictionary.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        key (str): The attribute name or metadata key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The value of the attribute or metadata key, if found. Returns &#39;NaN&#39; if not found.</span>

<span class="sd">    Example:</span>
<span class="sd">    # Retrieve attribute and metadata values from a Well instance:</span>
<span class="sd">    &gt;&gt;&gt; well = Well(name=&quot;B2&quot;, plate_id=2, coordinate=(1, 1), index=5, rgb_color=(0.5, 0.5, 0.5))</span>
<span class="sd">    &gt;&gt;&gt; well.metadata = {&quot;sample_type&quot;: &quot;plasma&quot;}    </span>
<span class="sd">    &gt;&gt;&gt; well.get_attribute_or_metadata(&quot;plate_id&quot;)</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; well.get_attribute_or_metadata(&quot;sample_type&quot;)</span>
<span class="sd">    &#39;plasma&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if it&#39;s a direct attribute</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;NaN&quot;</span><span class="p">)</span>
        <span class="c1"># return getattr(self, key, &quot;&quot;)</span>

    <span class="c1"># Check if it&#39;s a key in metadata</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;NaN&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>